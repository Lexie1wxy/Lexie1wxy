---
tags: 
- 信息安全
categories: 
- 考试
- 信息安全与技术
typora-root-url: ../_posts
---

# 信息安全与技术



![img](../images/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/clip_image002-1598431320149.jpg)

# 1.    1 引言

## 1.1.     1.1 网络安全概述

### 1.1.1.     计算机系统安全

#### 保护数据安全和防范攻击的技术和工具

### 1.1.2.     网络安全

#### 数据传输过程中保护数据

#### 两个方面

##### 信息载体

###### 针对系统和网络

##### 信息本身

###### 抵御对信息本身的安全威胁

## 1.2.     1.2 安全概念

### 1.2.1.     计算机安全

#### 目的：实现信息系统资源的机密性、完整性和可用性

## 1.3.     1.3 安全攻击

### 1.3.1.     OSI安全框架主要关注安全攻击，安全服务和安全机制

### 1.3.2.     安全威胁

#### 指破坏安全的潜在可能，有意/无意

#### 四要素（判断安全威胁是否存在）

##### 攻击者

##### 攻击方法

##### 实施攻击的漏洞

##### 被攻击的系统资源

### 1.3.3.     安全攻击

#### 安全攻击是指任何危及信息系统安全的行为，是某个人、物或事件对网络资源的机密性、完整性、可用性和非否认性等所造成的危害。

#### RFC规范分类

##### 被动攻击

###### 不改变数据，只读取

###### 对信息机密性的攻击

###### 形式

析出消息内容

截获数据并对数据进行分析获得信息

对应安全机制：数据加密

通信量分析

通过观察消息模式，推测通信双方的身份位置，猜测正在发生的通信的性质

对应安全机制：流量填充

###### 特点

难以检测

可以预防

##### 主动攻击

###### 修改数据甚至控制信号，或者有意伪造数据，因而比被动攻击更具危害性

###### 形式

篡改

篡改攻击

对信息完整性的攻击。

是指修改内容、延迟传输或改变顺序等，以获得非授权的效果。

消息重放

也是一种篡改攻击，是对消息发送时间的篡改。

消息重放是将获得的消息再次发送以产生非授权的效果。

伪装

对信息真实性的攻击。

伪装是一个实体假装成另一个实体以获得非授权的效果

拒绝服务攻击

对信息可用性的攻击。

目的是中断或干扰通信设施或服务的正常使用和管理

###### 特点

难以预防

易于检测

###### 对付方法：检测攻击，并从破坏中恢复

## 1.4.     1.4 安全服务

### 1.4.1.     从·网络安全系统提供的用于保护网络安全的服务，通过安全机制实现安全策略

### 1.4.2.     包括

#### 机密性

##### 用于保护系统免受被动攻击，系统为防止数据被非法访问或截获而泄露所提供的保护

##### 分类

###### 数据机密性

###### 通信量机密性

##### 安全机制

###### 加密

###### 流量填充

#### 完整性

##### 用于保护消息免受篡改，确保消息未被插入，修改，重排序，重放

##### 安全机制

###### 加密

###### 数字签名

###### 报文鉴别

#### 认证

##### 信息真实性，一方确认另一方身份

##### 安全机制

###### 加密

###### 数字签名

#### 访问控制

##### 限制和控制通信链路对主机和系统资源进行访问的能力，前提是身份认证或鉴别

##### 分类

###### 自主访问控制策略

为特定用户提供访问资源的权限

又称基于身份的策略

是指对某个客体具有控制权的主体可以将对该客体的一种或多种访问权限自主地授予其他主体，并在随后地任何时候将这些权限回收

###### 强制访问控制策略

基于一组能自动实施的规则

又称基于规则的策略

根据主题被信任程度和客体所包含消息的机密性或敏感程度来决定主体对客体的访问权，往往通过安全标记来实现

典型策略

多级策略

访问控制规则

只读访问规则

又称简单安全条件-不向上读

只写访问规则

又称*-特性-不向下写

#### 非否认性

##### 防止发送方或接收方抵赖所传输的消息

##### 安全机制

###### 数字签名

###### 共同信赖的第三方仲裁

#### 可用性

##### 根据系统的性能说明，能够按照被授权实体的要求访问或使用系统资源

##### 依赖于访问控制和其他安全服务

## 1.5.     1.5 安全评价准则

### 1.5.1.     美国可信计算机系统安全评价准则TCSEC

### 1.5.2.     分类

#### 分为四大类：D、B、C、A

#### 从低到高：D-C1-C2-B1-B2-B3-A七个级别

#### D类

##### 经过评价但不能达到任何更高级别要求的系统

#### C类

##### C1

###### 自主安全保护

##### C2

###### 受控安全保护

#### B类

##### B1 

###### 标记安全保护

##### B2

###### 结构化保护

##### B3

###### 安全域

#### A类

##### 经过验证的保护

### 1.5.3.     可信计算基TCB：系统安全相关的保护

## 1.6.     1.6 网络安全模型

### 1.6.1.     加密安全模型

#### 用户消息通过网络传输，需要安全系统对传输的消息进行保护，这一类安全模型叫做加密安全模型

#### 涉及

##### 参与者+信息通道+安全机制

##### 参与者

###### 发送方+接收方+可信的第三方+攻击者

#### 安全机制

##### 安全变换

###### 加密变换

###### 流量填充

###### 数字签名

###### 报文鉴别

###### 与其相关的是安全变换算法+算法参数：秘密信息

##### 秘密信息

#### 任务

##### 设计安全变换算法

##### 生成秘密信息

##### 设计秘密信息发布和共享的方法，可以由可信的第三方发布，亦可以由通信双方任何一方发布

##### 设计保证通信安全的协议

### 1.6.2.     访问安全模型

#### 攻击者有可能试图通过网络对系统资源进行非法访问，此时需要对资源系统提供安全保护

#### 涉及

##### 攻击者+访问信道+安全机制+资源系统

##### 攻击者

###### 人或软件

##### 资源系统

###### 计算/数据/软件资源

#### 两道安全防线

##### 外部安全防线

###### 隔离或过滤作用

###### 身份鉴别+防火墙

##### 系统内部安全防线

# 2.    2 密码学基本原理

## 2.1.     2.1 密码学基本概念

### 2.1.1.     密码学

#### 目的

##### 研究数据保密，秘密变换信息防止被第三方窃取

#### 核心

##### 密码技术

#### 分类

##### 密码编码技术

###### 找到高安全性的有效密码算法和协议，以满足对消息进行安全保护的要求

###### 目的

保护明文、密钥，防止攻击者非法窃取

##### 密码分析技术

###### 试图破解或伪造认证信息，试图窃取机密信息或进行诈骗活动的目的

###### 目的

密钥未知的情况下试图恢复明文或者密钥

### 2.1.2.     密码系统

#### 明文P

##### 加密变换前的原信息

#### 密文C

##### 加密变换后的信息

#### 加密算法E

##### 加密变换使用的算法（稳定且公开）

#### 解密算法D

##### 解密变换使用的算法（E的逆过程）

#### 密钥

##### 加/解密过程中引入的一个相同或者两个不同但相关的参数

#### 由于加密算法通常公开，使用被加密信息的安全性通常取决于密钥的安全性

## 2.2.     2.2 密码体制

### 2.2.1.     概念

#### 加/解密过程中采用方法的种类

### 2.2.2.     分类方法

#### 加解密密钥是否相同

##### 对称密码体制

###### 加解密钥相同，密钥必须保密

###### 又称：常规/单/秘密密钥密码体制

###### 特点

加密效率较高

保密强度较高

难以满足开放式系统的要求

##### 非对称密码体制

###### 公钥对外开放，私钥保密，公钥不可推出私钥

###### 又称：双/公开密钥密码体制

###### 特点

密钥分配方便，能够用于鉴别和数字签名

较好的满足开放式系统的要求

算法复杂度高，开销大，不适合大量数据加密处理

#### 密文是否与明文段位置有关

##### 分组密码体制

###### 密文仅与加密算法和密钥有关，与明文段位置无关

###### 对固定长度的明文分组加密，生成相同固定长度的密文分组

##### 序列密码体制

###### 密文不仅与加密算法和密钥有关，还与明文段所在位置有关

###### 每次对较小的明文单元处理，通常以比特（或字节）为加密单元，将明文流和密钥流结合形成密文流

###### 密文流

与明文流等长的伪随机序列（密钥流也是）

###### 类似于一次一密体制

#### 加密变换是否可逆

##### 单向密码体制

##### 双向密码体制

#### 是否引入客观随机因素

##### 确定型密码体制

##### 概率密码体制

## 2.3.     2.3 密码分析

### 2.3.1.     攻击目标

#### 恢复密钥而不仅仅是单个明文

### 2.3.2.     攻击策略

#### 取决于攻击者掌握的信息和加密方案的性质

### 2.3.3.     获得信息类型

#### 1、加密算法

#### 2、密文

#### 3、一个或多个明文、密文对

#### 4、攻击者所选择的明文，以及该明文所对应的密文

#### 4、攻击者所选择的密文，以及该密文所对应的明文

### 2.3.4.     攻击类型

#### 唯密文攻击

##### 1+2

##### 攻击手段

###### 穷举攻击

#### 已知明文攻击

##### 1+2+3

#### 选择明文攻击

##### 1+2+4

##### 差分密码分析

#### 选择密文攻击

##### 1+2+5

#### 选择文本攻击

##### 1+2+4+5

#### 一般地，加密算法要能够抵挡已知明文攻击

### 2.3.5.     与加密算法强度相关概念

#### 无条件安全

##### 除一次一密方案外不存在无条件安全地加密方案

#### 计算上安全

##### 满足两个准则之一

##### 准则

###### 破译该密码的成本超过被加密信息价值

###### 破译该密码的时间超过被加密信息生命周期

### 2.3.6.     穷举攻击

#### 除密码分析的另一种攻击

#### 一般必须尝试所有密钥的1/2才可能成功

# 3.    3 古典密码

## 3.1.     3.1替代技术

### 3.1.1.     概念：将明文中每个元素（比特、字母、比特组合或字母组合）映射为另一个元素的技术

### 3.1.2.     分类

#### 单字母替代密码

##### 凯撒密码

###### 明文每个字母用其后第三个字母代替

###### c=（m+3）mod 26

###### 密钥空间 3

##### 移位密码

###### 明文每个字母用其后第k个字母代替（偏移值可更改）

###### c=（m+k）mod 26

###### 密钥空间 k

##### 仿射密码

###### c=（am+b）mod 26

###### m=a^-1(c-b)mod 26

#### 多字母替代密码

##### Vigenere密码

###### Ci=（Mi+K(i mod r）mod 26

###### Mi=（Ci-K(i mod r）mod 26

###### 使用不同密钥对应不同的单字母替代

###### 密钥空间 26^r

##### Hill密码

###### 密钥K为n*n的矩阵

## 3.2.     3.2置换技术

### 3.2.1.     概念：在不丢失信息的其前提下对明文中的元素进行重新排序，以打乱明文字母的位置和顺序 y= f（x）

# 4.    4 对称密码

## 4.1.     4.1概述

### 4.1.1.     对称密码模型

#### CS=（P，C，E，D，K）

### 4.1.2.     分类

#### 分组密码

#### 序列密码（流密码）

## 4.2.     4.2分组密码原理与操作模式

### 4.2.1.     分组密码原理

#### 安全性

##### 加密算法公开，常规加密算法的安全性取决于密钥的安全性（密钥对安全的影响主要包括两个方面）

##### 密钥安全

###### 密钥长度

###### 密钥更新频率

#### 扩散与扰乱

##### 扩散

###### 让明文和密钥的每个字母影响尽可能多的密文字母的取值，从而使得明文和密钥的统计特征被扩散

###### 密文中多字母组合的出现频率比在明文和密钥中出现的频率均匀，明文和密钥中原有的统计特征不再反映在密文中

##### 扰乱

###### 使明文与密钥与密文的统计特征的关系尽可能复杂化

###### 使得攻击者即使掌握了密文的某些统计特征，也很难从中推测出密钥和明文。

#### Feistel分组密码

##### PPT-11图（会考）

##### 安全性相关参数

###### 分组长度

分组越长安全性越高，加解密速度越慢，通常64

###### 密钥长度

密钥越长安全性越高，加解密速度越慢，通常128或更长

###### 循环次数

循环次数越多安全性越高，加解密速度越慢，通常16次

###### 子密钥生成算法

子密钥生成算法越复杂，安全性越高

###### 轮函数

轮函数越复杂，扩散与扰乱功能越强，安全性越高

### 4.2.2.     分组密码模式

#### 电子密码本ECB

##### Ci=Ek[Pi]

##### 明文划分为w比特的明文分组，最后一个分组视情况填充，每个分组相同密钥加密

##### 特点

###### 相同的明文分组产生相同的密文分组

###### 由于明文加密过程和密文无关，因此可以并行加密处理，获得很高的加密速度

#### 密文分组链接CBC

##### Ci=Ek[Ci-1 异或 Pi]

##### 当前明文和上一次输出的密文分组异或，然后加密算法处理

##### 特点

###### 相同的明文分组产生不同的密文分组

###### 适用于大量信息和高结构化信息的加密传输

#### 密文反馈模式CFB

##### 能将任意分组密码转换为流密码，本质是利用分组加密模块产生密钥流（注意——解密时使用的也是加密函数）

##### 特点

###### CFB中与明文异或的密钥流和密文相关

###### 若传输中密文出错，会造成解密错误

###### 由于错误码在被移出移位寄存器之前被多次使用，所以一个密文单元出错，会造成连续w/h个解密明文的错误

#### 输出反馈模式OFB

##### 能将分组密码转换为流密码，和CFB相似，但CFB是反馈密文单元，OFB是反馈加密函数的输出反馈（注意——解密时使用的也是加密函数）

##### 特点

###### 优点

传输中的比特差错不会传播

###### 缺点

比CFB更容易受到报文流篡改攻击

###### 具有典型的流密码结构

#### 计数器模式CTR

##### 使用和明文分组等长的计数器，在加密不同的明文分组时该计数器的值不同

##### 特点

###### 对报文分组时无需对明文进行填充

###### 初始计数器必须是时变的，即所有使用相同密钥加密的所有报文必须使用不同的初始计数器值，且Ti值也必须唯一

## 4.3.     4.3 数据加密标准DES

### 4.3.1.     使用最广泛的常规加密体制

### 4.3.2.     DES加密与解密

#### 概念

##### 严格的Feistel结构，以明文分组和密钥作为输入

##### 明文长度——64bit

##### 密钥长度——56bit

##### 16轮循环

#### 步骤

##### 1、初始置换

##### 2、16轮置换加迭代

##### 3、初始置换的逆置换

#### 特点

##### 具有很强的雪崩效应

##### 雪崩效应：明文或密钥及其微小的变化都会引起密文发生大的改变

### 4.3.3.     简化DES

#### 概念

##### 明文长度——8bit

##### 密钥长度——10bit

#### 计算题

### 4.3.4.     替代方式

#### 由于——DES算法的密钥长度只有56bits，比较脆弱需要替代算法

#### DES算法多次加密

##### 双重DES算法

###### 概念：利用两个不同密钥对明文进行两次连续加密处理

###### 致命缺陷

易受中途攻击

##### 三重DES算法

###### 对付中途攻击的最好办法：使用三个密钥进行加密

###### 分类

双密钥三重DES

概念：利用两个不同密钥对明文进行三次连续加密处理，第一次和第三次加密密钥相同

方案

DES-EEE2

加加加密——解解解密

DES-EDE2

加解加密——解加解密

DES-EDE2优点在于可以解密原来单次DES所加密的数据，K1=K2时

密钥长度112

三密钥三重算法

概念：利用三个不同密钥对明文进行三次连续加密处理

方案

DES-EEE3

加加加密——解解解密

DES-EDE3

加解加密——解加解密

DES-EDE3优点在于可以解密原来单次DES所加密的数据，K1=K2=K3时

密钥长度168

#### 设计新的算法

##### 高级加密标准AES

###### 概述

特点

分组长度128

密钥长度可变---128/192/256

根据密钥长度不同，AES分别被称为AES-128，AES-192，AES-256

状态：

AES算法明文分组需要多次变化，操作的中间结果叫做状态

4*4的字节方阵

密钥

4*Nk的字节方阵

Nk=密钥长度/32

循环轮数Nr

Nr和Nk的关系，Nr=Nk+6

轮函数：由4个不同的可逆均匀变换组成，在每轮替换和移位时并行处理整个数据分组

###### 轮循环

字节替代

逆字节替代

移行

逆移行

混列

逆混列

加轮密钥

加轮密钥（逆变换即其本身）

###### ps

w[i]的值依赖于w[i-1] 和w[i-4]

##### RC5算法

###### 概念

一种快速的参数化分组密码算法

###### 概述

参数

字长w

取值：16、32、64

单位:bit

分组2w：32、64、128

循环轮数r

取值：[0~255]

密钥长度b

取值：[0~255]

单位：字节B

RC5-32/16/16建议RC5-w/r/b

强度

分组长度越长

循环轮数越多

密钥长度越长

但选择合适的循环轮数和密钥长度需要在安全性和计算速度之间进行均衡考量

###### 运算步骤及相关

运算

按位异或

加法/减法

模2w加法用于加密，记为+；

模2w减法用于解密，记为-

循环移位

左移加密

右移解密

RC5算法包括加密、解密、密钥扩展三个部分

子密钥个数

和循环轮数r相关

令2w表示分组长度，则RC5算法需要2r+2个子密钥，表示为数组S[2r+2],每个子密钥的长度为比特

###### 特点

简单、加密速度快，便于软件和硬件实现，可变的参数使得RC5安全性较高

##### SM4算法

###### 概念

一种分组加密算法

###### 参数

分组128bit

密钥128bit

循环32轮，以32位字单位进行加密运算

###### 基本运算

32bit异或

32bit循环左移

# 5.    5 非对称密码

## 5.1.     5.1 概述

### 5.1.1.     又称

#### 公钥密码或双密钥密码

### 5.1.2.     与对称密码的比较

####        

##### 常规加密  

###### 公开密钥加密

#### 加密解密

##### 同一密钥   

###### 不同但相关密钥

#### 安全条件

##### 密钥必须保密

###### 私钥保密

#### 加密速度

##### 快         

###### 慢

#### 方便性  

##### 密钥分配不便

###### 密钥公开方便

#### 密钥数量

##### N（N-1）/2

###### 2N

#### 功能    

##### 加密     

###### 加密、数字签名、密钥分配

### 5.1.3.     特点

#### 非对称密码是基于数学函数而不是替代和置换的。

#### 非对称密码体制中的密钥是非对称的，它使用两个不同的密钥，这影响保密通信、密钥分配和鉴别

#### 非对称密码成功地解决了计算机网络安全中的身份鉴别、数字签名等问题

#### 使密钥管理变得容易。

#### 非对称密码的加密和解密较对称密码体制慢。

## 5.2.     5.2 基本原理

### 5.2.1.     特点

#### 使用了两个不同但相关的密钥分别用于实现互逆运算，即加密和解密，其中一个密钥公开，叫做公钥

### 5.2.2.     应用

#### 加密/解密

##### 步骤

###### PPT22左

##### 在用于加密/解密时，发送方使用接收方公钥加密消息，接收方使用私钥解密消息；

#### 数字签名

##### 步骤

###### PPT22左

##### 在用于数字签名时，发送方使用私钥加密消息，而接收方使用发送方的公钥来解密消息，验证签名。

#### 密钥交换

### 5.2.3.     系统构成

#### 明文M密文C、公钥KU、私钥KR、加解密算法E/D

### 5.2.4.     双重加密

#### 同时提供机密性和认证功能

### 5.2.5.     公钥密码算法需满足的要求

#### PPT22

##### 通信双方生成密钥对容易

##### 已知接收方B的公钥KUB和待加密的消息M，发送方A生成相应的密文C在计算上是容易的：

##### 接收方B使用其私钥KRB解密密文C以恢复明文M时，在计算上是容易的：

##### 攻击者已知公钥KUB，试图推导出私钥KRB，在计算上是不可行的。

##### 攻击者已知公钥KUB和密文C，试图推导出明文M，在计算上是不可行的。

##### 加密变换和解密变换是互逆的，且可以以任意顺序使用：

#### 陷门单向函数

##### 陷门就是私钥

##### 称一个函数是陷门单向函数，是指该函数是易于计算的，但求它的逆是不可行的，除非知道某些附加信息（陷门）。当附加信息给定后，求逆可以在多项式时间完成。

### 5.2.6.     非对称密码体制的应用

#### 1、加密/解密：发送方使用接收方的公钥对消息进行加密，接收方使用自己的私钥对消息进行解密。

#### 2、数字签名：发送方使用自己的私钥对消息或鉴别符进行签名。其中，签名是通过对整个消息或对整个消息进行计算形成的鉴别符进行加密产生的。

#### 3、密钥交换：通信双方合作以交换会话密钥。有多种方法可以用于交换密钥，且在密钥交换过程中使用了非对称密码体制。

### 5.2.7.     各种l流行的公钥算法支持的应用范围

#### PPT22 右下表格

## 5.3.     5.3 RSA密码体制

### 5.3.1.     分成三个部分

#### 密钥生成

#### 加密

#### 解密

#### 看ppt-23

### 5.3.2.     安全性基于大整数分子分解的困难性

## 5.4.     5.4 Diffie-Hellman密钥交换

### 5.4.1.     算法

#### 安全性源于在有限域上计算离散对数的困难性

#### 算法本身仅限于密钥交换，不用于加密/解密和数字签名

### 5.4.2.     计算过程

#### PPT-25

### 5.4.3.     攻击过程

#### PPT-25

#### 是由于未对通信双方的身份进行身份鉴别

#### 解决方法：数字签名或者公钥证书

## 5.5.     5.5 ElGamal密钥体制

### 5.5.1.     安全性依赖于计算有限域上离散对数的难度（和5.4 Diffie-Hellman密钥交换相同）

### 5.5.2.     不用于密钥交换，只用于加密和数字签名

## 5.6.     5.3 椭圆曲线体制ECC优点

### 5.6.1.     ECC使用的密钥长度要比RSA的密钥长度短得多

### 5.6.2.     在密钥长度相同时，RSA与ECC所指向的计算量差不多

### 5.6.3.     因此，同等安全性条件下，ECC密钥更短，因此所需要的计算量也比RSA少

# 6.    6 数据完整性算法

## 6.1.     数据完整性可以确保收到的数据确实是授权实体发送的数据，并保护数据免受非法篡改。

## 6.2.     6.1 散列函数

### 6.2.1.     概念

#### 散列函数对报文的所有比特进行计算产生散列值，因而具有差错检测能力。

#### 即，报文中任意一比特或若干比特发生变化都将导致散列值发生变化。

### 6.2.2.     用于

#### 报文认证

#### 数字签名

### 6.2.3.     一般结构

#### 迭代型

#### 核心

##### 散列算法的核心是设计无碰撞的压缩函数f，攻击重点是f的内部结构，分析的过程需要找出f的碰撞。

### 6.2.4.     不同方式提供报文认证

#### 使用对称加密方法对附加散列值的报文进行加密

##### 机密性

##### 认证

#### 使用对称加密方法仅对散列值进行加密

##### 认证

#### 使用散列值、公共秘密值的明文方案

##### 认证

#### 使用散列值、公共秘密值的密文方案

##### 机密性

##### 认证

### 6.2.5.     不同方式提供数字签名

#### 使用公钥加密体制及源端私钥仅对散列值进行加密

##### 认证

#### 使用对称加密体制对报文和已使用公钥加密的散列值进行加密（1的基础上再对称加密）

##### 机密性

##### 认证

### 6.2.6.     散列函数H性质

#### 1、H能用于任意大小的数据分组；

#### 2、H产生定长的输出；

#### 3、对任意给定的x，H(x)要相对易于计算，使得硬件和软件实现成为可能；

#### 4、H应具有单向性，即对任意给定的散列值h，寻找x使得H(x) = h在计算上是不可行的；

#### 5、H应具有抗弱碰撞性，即对任意给定的分组x，寻找y≠x，使得H(y)=H(x)在计算上是不可行的；

#### 6、H应具有抗强碰撞性，即寻找任意的(x, y)对，使得H(x)=H(y)在计算上是不可行的。

#### 函数

##### 满足性质（1）至性质（5）的散列函数也称为单向散列函数或弱单向散列函数。

##### 若散列函数也满足性质（6），则称该散列函数为强单向散列函数。

### 6.2.7.     结论

#### 特别地，如果散列函数H生成的散列值长度为m比特，可能存在2^m个散列值，则k个值H(y1), H(y2),…, H(yk)中至少有一个等于H(x)的概率为1/2的k值为2^m-1。

#### 特别地，如果散列函数H生成的散列值长度为m比特，可能存在2^m个散列值，则k个值H(y1), H(y2),…, H(yk)中至少有两个相同的概率为1/2的k值为2^m/2。

### 6.2.8.     算法

#### MD5报文摘要算法

##### 参数

###### 报文

任意长度

###### 报文摘要

128bit

###### 分组

512bit

##### 步骤

###### 对报文进行填充

###### 附加报文的长度

小端对齐

###### 初始化MD缓存

###### 处理512比特报文分组序列

###### 输出报文摘要

##### 每轮计算

###### 公式

a ← b + CLSs(a + g(b, c, d) + X[k] + T[i])

###### 含义

a,b,c,d为缓存的4个32比特字，运算完成后向右循环一个字，即得到该步迭代的输出；

g是基本逻辑函数F、G、H、I之一；

CLSs表示循环左移s位，s的取值参见循环移位表；

X[k]=M[q×16+k]，即报文第q个分组中的第k个32比特字，k=1, 2, …, 16；

T[i]为常量表T中的第i个字；

+为对应32比特字的模2^32加法

##### 4轮16步

#### SHA安全散列算法

##### 步骤

###### 对报文进行填充

###### 附加报文的长度

大端对齐

###### 初始化缓存

###### 处理1024比特报文分组序列

###### 输出报文摘要

##### 80步

##### 参数

###### 报文

<=2^128

###### 报文摘要

512bit

###### 分组

1024bit

## 6.3.     6.2 报文认证码MAC

### 6.3.1.     报文认证

#### 概念

##### 报文认证是用于验证报文完整性的一种安全机制或服务。

##### 报文认证确保收到的信息在传输过程中未被篡改，且发送端声称的身份是真实有效的。

#### 主要内容

##### 报文认证与报文认证码

##### 报文认证函数

##### 基于散列函数的报文认证码HMAC

##### 基于分组密码的报文认证码CMAC

### 6.3.2.     报文认证与报文认证码

#### 网络攻击形式

##### 被动攻击

###### 1、消息析取

###### 2、通信量分析

##### 主动攻击

###### 3、伪装

###### 篡改

4、内容篡改

5、序号篡改

6、计时篡改

###### 7、抵赖

#### 对付方法

##### 对付第（1）（2）类攻击的措施是加强报文的保密性，即加密与流量填充。

##### 对付第（3）（4）（5）（6）类攻击的措施是报文认证。

##### 对付第（7）类攻击的措施是数字签名，一般地，数字签名也能够对付第（3）～（6）类攻击。

#### 报文认证码和散列函数的区别：

##### 散列函数不使用密钥

##### 报文认证码使用密钥

### 6.3.3.     报文认证函数

#### 产生认证码的函数分为

##### 报文加密

##### 报文认证码MAC

##### 散列函数

#### 报文加密

##### 以整个报文的密文作为认证符；

##### 实现认证的方式

###### 对称加密：提供机密性与认证

###### 非对称加密：提供机密性

###### 非对称加密：提供认证与数字签名

###### 非对称加密：提供机密性、认证与数字签名

#### 报文认证码MAC

##### 以一个公共函数和密钥产生一个定长值作为认证符；

##### 实现认证的方式

###### 报文认证，不提供机密性

###### 报文认证与机密性，报文认证码与明文连接

###### 报文认证与机密性，报文认证码与密文连接

#### 散列函数

##### 一个将任意长度的报文映射为定长的散列值的公共函数，以散列值作为认证符。

### 6.3.4.     基于散列函数的报文认证码HMAC

#### HMAC算法的输出:

##### HMACK(M)=H[(K+⊕opad)||H[(K+⊕ipad)||M]]

#### HMAC算法可以描述如下：

##### （1）对密钥K的左端填充0以生成一个b比特的串K+；

##### （2）将K+与ipad按比特异或产生一个b比特的分组Si；

##### （3）将报文M附加到Si后；

##### （4）使用散列函数H计算步骤（3）所产生数据流的散列值；

##### （5）将K+与opad按比特异或产生一个b比特的分组So；

##### （6）将步骤（4）产生的散列值附加到So后；

##### （7）使用散列函数H计算步骤（6）所产生数据流的散列值，并输出最终结果

### 6.3.5.     基于分组密码的报文认证码CMAC

## 6.4.     6.3 数字签名

### 6.4.1.     概念

#### 不仅可以保证信息的完整性和信息源的可靠性，而且可以防止通信双方的欺骗和抵赖行为。

### 6.4.2.     性质

#### 必须能够验证签名生成者的身份，以及生成签名的时间；

#### 能够用于证实被签名消息的内容；

#### 数字签名必须能被第三方验证，从而解决通信双方的争议。

### 6.4.3.     使用方式

#### 直接数字签名

#### 需仲裁的数字签名

### 6.4.4.     ElGamal数字签名算法

#### 使用私钥进行加密，使用公钥进行解密。

#### 安全性同样依赖于计算有限域上离散对数的难度。

### 6.4.5.     数字签名标准DSS

### 6.4.6.     数字签名算法DSA

# 7.    7 密钥分配与用户认证

## 7.1.     7.1 密钥分配

### 7.1.1.     概念

#### 密钥分配是为需要交换安全加密数据的双方分发密钥，并提供密钥安全分发所需要的方法或协议。

### 7.1.2.     主要内容

#### 基于对称加密的秘密密钥分配

#### 基于非对称加密的秘密密钥分配

##### 公钥加密的效率较低，不太适合用于保密通信，但将其用于分配对称加密的秘密密钥却是非常合适的。

##### 秘密密钥分配方式

###### 简单的秘密密钥分配

问题

易受主动攻击

###### 具有机密性和认证功能的秘密密钥分配

#### 公钥分发

##### 公钥分配方法

###### 公开宣布

###### 公开可以得到的目录

###### 公开密钥管理机构

公钥管理机构

维护一个所有参与者的公钥动态目录

###### 公开密钥证书

时间戳验证证书的时效性

## 7.2.     7.2 用户认证原理

### 7.2.1.     概念

#### 用户认证是证实被认证对象是否属实和是否有效的一个过程。

### 7.2.2.     分类

#### 双向认证

##### 双向认证协议能够使通信双方互相认证彼此的身份，并交换会话密钥。

#### 单向认证

##### 在有些情况下无需相互认证对方的身份，而仅对通信一方的身份进行认证，即单向认证。

## 7.3.     7.3 Kerberos

### 7.3.1.     概念

#### 基于可信第三方的认证系统。

#### 提供一个集中的认证服务器，其功能是实现服务器与用户之间的双向认证。

### 7.3.2.     问题

#### 1、

##### 任何客户都可向服务器申请服务，为防止用户对服务器未授权访问，服务器必须能够认证请求服务的用户的身份

##### 解决方案

###### 使用一个认证服务器AS

#### 2、

##### 希望使用户访问同一种服务时必须输入口令的次数最少

##### 解决方案

###### 使用服务许可票据

#### 3、

##### 对不同的服务用户需要新的票据的问题

##### 解决方案

###### 使用票据许可票据

利用票据许可票据可以获得服务许可票据。

#### 4、

##### 票据的生存期问题

##### 解决方案

###### 使得网络服务必须能证明使用票据的人即是申请票据的人

#### 5、

##### 服务器向用户认证自己

##### 解决方案

###### 使用双向认证。

## 7.4.     7.4 X.509证书与公钥基础设施

### 7.4.1.     概念

#### 定义了一种提供认证服务的框架。

### 7.4.2.     主要内容

#### X.509证书

##### 本质上，X.509证书是由可信的第三方——证书权威机构（CA）签发的一个关于实体及其公钥关联的数字声明，该证书具有权威性。

##### 可信的第三方

###### 是称为CA的证书权威机构，该机构负责认证用户的身份并向用户签发数字证书。

##### 核心

###### 是公钥、公钥持有者（主体）和CA的签名，证书完成了公钥与公钥持有者的权威性绑定。

##### 由于证书是不可伪造的，因此将其放入目录后无需对目录施加特别的保护措施。

##### 特点

###### 任何拥有CA公钥的用户都可以对该CA签发的证书进行验证，从而获得一个可信的用户公钥。

###### 除证书权威机构CA外任何一方都不可能不被察觉地修改证书。

##### 基于

###### 公开密钥加密+数字签名

加密算法推荐使用RSA

数字签名要求使用散列函数。

##### 两部分构成

###### 信息部分(I)

###### 数字签名部分(S)

##### 格式 

###### 看PPT

###### 和第二版区别

颁发者唯一标识符

主体唯一标识符

###### 和第三版区别

证书扩展

##### 证书的格式、证书的获取、证书链、证书的撤销、证书的验证、证书的撤销列表

#### 公钥基础设施

##### PKIX















